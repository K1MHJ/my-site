---
import { getCollection } from "astro:content";

export async function getStaticPaths({ paginate }) {
  const posts = (await getCollection("blog"))
    .filter((p) => !p.data.draft)
    .sort((a, b) => +b.data.date - +a.data.date);
  return paginate(posts, { pageSize: 10 });
}

const { page } = Astro.props;
---

<main class="mx-auto max-w-3xl p-6">
  {page.data.map((post) => (
    <article class="mb-6">
      <h2 class="text-xl font-medium">
        <a href={`/posts/${post.slug}`}>{post.data.title}</a>
      </h2>
      <p class="text-sm text-gray-600">
        {post.data.date.toISOString().slice(0,10)}
        {post.data.tags?.length ? ` · ${post.data.tags.join(", ")}` : ""}
      </p>
      {post.data.description && <p class="mt-1">{post.data.description}</p>}
    </article>
  ))}

  <nav class="flex items-center gap-3 mt-8">
    {page.url.prev && <a href={page.url.prev} class="border px-3 py-1 rounded">이전</a>}
    <span class="text-sm">페이지 {page.currentPage} / {page.lastPage}</span>
    {page.url.next && <a href={page.url.next} class="border px-3 py-1 rounded">다음</a>}
  </nav>
</main>